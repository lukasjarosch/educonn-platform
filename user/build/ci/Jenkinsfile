node {
	ws("${JENKINS_HOME}/jobs/${JOB_NAME}/builds/${BUILD_ID}") {
		withEnv(["GOPATH=${JENKINS_HOME}/jobs/${JOB_NAME}/builds/${BUILD_ID}"]) {
					env.PATH="${GOPATH}/bin:$PATH"
						stage('Checkout'){
						echo 'Checking out SCM'
						checkout scm
						}
					stage('Build') {
						echo 'Building'
						dir('src/github.com/lukasjarosch/educonn-platform/') {
						    sh('make user-docker')
						}
					}
					stage('Publish') {
					    steps {
					        withDockerRegistry([ credentialsId: "1f664f6b-8f57-435a-bda6-5de629641b79", url: "" ]) {
					            sh 'make user-publish'
					        }
					    }
					}
		}
	}
}
